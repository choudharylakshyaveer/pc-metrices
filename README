# pc-metrices
# PC Metrics ‚Äì Help & Documentation

This document explains how to run, configure, and use the **PC Metrics system**, which collects live CPU & RAM metrics from a Windows machine, publishes them to Kafka, and exposes them via a REST API.

---

## üß© Architecture Overview

```
[ Windows Machine ]
        |
        |  (CPU, RAM metrics every 1s)
        v
[ pc-metrics-producer ]
        |
        |  Kafka Topic: system-metrics
        v
[ Kafka Cluster (3 brokers) ]
        |
        v
[ pc-metrics-consumer ]
        |
        v
[ REST API ]  -->  /api/metrics/live
```

---

## üì¶ Components

### 1Ô∏è‚É£ pc-metrics-producer

* Collects **live CPU and memory metrics**
* Publishes metrics to Kafka topic
* Runs as a Spring Boot application

### 2Ô∏è‚É£ pc-metrics-consumer

* Consumes metrics from Kafka
* Stores latest metrics in memory
* Exposes REST API for live metrics

### 3Ô∏è‚É£ Kafka Cluster

* 3 Kafka brokers
* 1 Zookeeper instance
* Runs via Docker Compose

---

## üê≥ Kafka ‚Äì Docker Setup

### Start Kafka Cluster

```bash
docker compose up -d
```

### Kafka Brokers

| Broker  | External Port |
| ------- | ------------- |
| kafka-1 | 9092          |
| kafka-2 | 9093          |
| kafka-3 | 9094          |

### Topic Used

* **system-metrics**

Create topic manually (optional):

```bash
docker exec kafka-1 /usr/bin/kafka-topics \
  --create \
  --topic system-metrics \
  --bootstrap-server kafka-1:29092 \
  --replication-factor 1 \
  --partitions 3
```

---

## ‚öôÔ∏è Configuration

### Producer ‚Äì `application.yml`

```yaml
spring:
  application:
    name: pc-metrics-producer

  kafka:
    bootstrap-servers: localhost:9092,localhost:9093,localhost:9094

metrics:
  topic: system-metrics
  publish-rate-ms: 1000
```

### Consumer ‚Äì `application.yml`

```yaml
spring:
  application:
    name: pc-metrics-consumer

  kafka:
    bootstrap-servers: localhost:9092,localhost:9093,localhost:9094

server:
  port: 8081
```

---

## ‚ñ∂Ô∏è Running the Applications

### 1Ô∏è‚É£ Start Kafka

```bash
docker compose up -d
```

### 2Ô∏è‚É£ Start Producer

```bash
cd pc-metrics-producer
mvn spring-boot:run
```

### 3Ô∏è‚É£ Start Consumer

```bash
cd pc-metrics-consumer
mvn spring-boot:run
```

---

## üåê REST API

### Live Metrics Endpoint

```
GET http://localhost:8081/api/metrics/live
```

### Sample Response

```json
{
  "cpuUsage": "15.37 %",
  "totalMemory": "63.11 GB",
  "usedMemory": "23.55 GB",
  "availableMemory": "39.56 GB",
  "timestamp": "2026-02-11 17:45:24"
}
```

### HTTP Status Codes

| Code | Meaning                 |
| ---- | ----------------------- |
| 200  | Metrics available       |
| 204  | No metrics received yet |

---

## üß† Design Decisions

* Kafka messages use **raw values** (bytes, epoch time)
* REST API returns **human-readable formatted values**
* No deprecated Kafka or Jackson APIs used
* DTO-based formatting for clean separation

---

## üß™ Troubleshooting

### ‚ùå Kafka connection error

```
Connection to node -2 could not be established
```

‚úî Ensure Docker Kafka is running
‚úî Verify `bootstrap-servers` ports match Docker compose

---

### ‚ùå No metrics in API

* Ensure producer is running
* Check consumer logs for Kafka consumption
* Call API after a few seconds

---

## üöÄ Possible Enhancements

* Server-Sent Events (SSE) for real-time streaming
* WebSocket support
* RAM usage percentage
* Metrics persistence (DB / Redis)
* Prometheus / Grafana integration

---

## üìå Summary

This system provides:

* Live system monitoring
* Kafka-based decoupling
* Clean REST API for dashboards
* Docker-based local setup

You now have a **production-style metrics pipeline** üéâ
